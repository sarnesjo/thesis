\documentclass{beamer}

\usepackage[utf8]{inputenc}
\usepackage{clrscode3e}
\usepackage{gnuplot-lua-tikz}
\usepackage{tikz}
\usepackage{verbatim}

\usetikzlibrary{positioning}

\renewcommand{\gets}{\leftarrow}
\newcommand{\AND}{\land}
\newcommand{\IOR}{\lor}
\newcommand{\XOR}{\oplus}
\newcommand{\NOT}{\lnot}

\title{Using binary decision diagrams to determine program equivalence in a superoptimizer}
\author{Jesper SÃ¤rnesjÃ¶}
\date{}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

\begin{frame}
\begin{figure}
\include{so_program_length_1}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\include{so_program_length_2}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\include{so_program_length_3}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\include{bdd_c1_1}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\include{bdd_c1_2}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\include{bdd_c1_3}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\include{bdd_c1_4}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\include{bdd_c1_5}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\include{bdd_c1_6}
\end{figure}
\end{frame}

\begin{frame}
\begin{codebox}
\Procname{$\proc{stc}()$}
\zi $f_c \gets 1$
\end{codebox}
\end{frame}

\begin{frame}
\begin{codebox}
\Procname{$\proc{mov}(a,b)$}
\zi \For $i \gets 0$ \To $n-1$
\zi \Do
      $a_i \gets b_i$
    \End
\end{codebox}
\end{frame}

\begin{frame}
\begin{codebox}
\Procname{$\proc{cmov}(a,b)$}
\zi $c \gets \id{condition}$
\zi \For $i \gets 0$ \To $n-1$
\zi \Do
      $a_i \gets \NOT c \AND a_i \IOR c \AND b_i$
    \End
\end{codebox}
\end{frame}

\begin{frame}
\begin{codebox}
\Procname{$\proc{and}(a,b)$}
\zi \For $i \gets 0$ \To $n-1$ \Do
\zi   $a_i \gets a_i \AND b_i$ \End
\zi $f_c \gets 0$
\zi $f_o \gets 0$
\zi $f_p \gets \NOT(a_0 \XOR a_1 \XOR ... \XOR a_7)$
\zi $f_s \gets a_{n-1}$
\zi $f_z \gets \NOT(a_0 \IOR a_1 \IOR ... \IOR a_{n-1})$
\end{codebox}
\end{frame}

\begin{frame}
\begin{codebox}
\Procname{$\proc{add}(a,b)$}
\zi $c_0 \gets a_0 \AND b_0$
\zi $a_0 \gets a_0 \XOR b_0$
\zi \For $i \gets 1$ \To $n-1$ \Do
\zi   $c_i \gets a_i \AND b_i \IOR a_i \AND c_{i-1} \IOR b_i \AND c_{i-1}$
\zi   $a_i \gets a_i \XOR b_i \XOR c_{i-1}$ \End
\zi $f_c \gets c_{n-1}$
\zi $f_o \gets c_{n-1} \XOR c_{n-2}$
\zi $f_p \gets \NOT(a_0 \XOR a_1 \XOR ... \XOR a_7)$
\zi $f_s \gets a_{n-1}$
\zi $f_z \gets \NOT(a_0 \IOR a_1 \IOR ... \IOR a_{n-1})$
\end{codebox}
\end{frame}

\begin{frame}
\begin{codebox}
\Procname{$\proc{imul}(a,b)$}
\zi \For $j \gets 0 \To n-1$ \Do
\zi   $x \gets a_{0} \AND b_{j}$
\zi   $c_{j} \gets p_{j} \AND x$
\zi   $p_{j} \gets p_{j} \XOR x$
\zi   \For $i \gets j+1 \To 2n-1$ \Do
\zi     $x \gets a_{i-j} \AND b_{j}$
\zi     $c_{i} \gets p_{i} \AND x \IOR p_{i} \AND c_{i-1} \IOR x \AND c_{i-1}$
\zi     $p_{i} \gets p_{i} \XOR x \XOR c_{i-1}$ \End \End
\zi \For $i \gets 0 \To n-1$ \Do
\zi   $a_{i} \gets p_{i}$ \End
\zi $f_c \gets f_o \gets p_{n} \IOR p_{n+1} \IOR ... \IOR p_{2n-1}$
\end{codebox}
\end{frame}

\begin{frame}
\begin{codebox}
\Procname{$\proc{imul}(a,b)$}
\zi \For $j \gets 0 \To n-1$ \Do
\zi   $x \gets a_{0} \AND b_{j}$
\zi   $c_{j} \gets p_{j} \AND x$
\zi   $p_{j} \gets p_{j} \XOR x$
\zi   \For $i \gets j+1 \To n-1$ \Do
\zi     $x \gets a_{i-j} \AND b_{j}$
\zi     $c_{i} \gets p_{i} \AND x \IOR p_{i} \AND c_{i-1} \IOR x \AND c_{i-1}$
\zi     $p_{i} \gets p_{i} \XOR x \XOR c_{i-1}$ \End
\zi   \For $i \gets n \To 2n-1$ \Do
\zi     $o \gets o \IOR a_{i-j} \AND b_{j}$ \End
\zi   $o \gets o \IOR c_{n-1}$ \End
\zi \For $i \gets 0 \To n-1$ \Do
\zi   $a_{i} \gets p_{i}$ \End
\zi $f_c \gets f_o \gets o$
\end{codebox}
\end{frame}

\begin{frame}
\begin{codebox}
\Procname{$\proc{sign}(a)$}
\zi \If $a > 0$ \Do
\zi   \Return $1$ \End
\zi \If $a < 0$ \Do
\zi   \Return $-1$ \End
\zi \Return $0$
\end{codebox}
\end{frame}

\begin{frame}
\begin{table}
\begin{tabular}{l|rrr}
length & & & \\
\hline
1 &         3 &   0 &   0 \\
2 &       155 &   0 &   0 \\
3 &     11849 &   0 &   0 \\
4 &   1082001 &   2 &   1 \\
5 & 121268867 & 326 & 209 \\
\end{tabular}
\end{table}
\end{frame}

\begin{frame}[containsverbatim]
\begin{table}
\begin{tabular}{l|lll}
& \verb|r0| $>$ 0
& \verb|r0| $<$ 0
& \verb|r0| $=$ 0 \\
\hline
\verb|add r0,r0|
& \verb|r0| $\gets X$, \verb|cf| $\gets 0$
& \verb|r0| $\gets Y$, \verb|cf| $\gets 1$
& \verb|r0| $\gets 0$, \verb|cf| $\gets 0$ \\
\verb|sbb r1,r1|
& \verb|r1| $\gets 0$
& \verb|r1| $\gets -1$
& \verb|r1| $\gets 0$ \\
\verb|sub r1,r0|
& \verb|r1| $\gets -X$, \verb|cf| $\gets 1$
& \verb|r1| $\gets -1-Y$, \verb|cf| $\gets 0$
& \verb|r1| $\gets 0$, \verb|cf| $\gets 0$ \\
\verb|adc r1,r0|
& \verb|r1| $\gets 1$
& \verb|r1| $\gets -1$
& \verb|r1| $\gets 0$ \\
\end{tabular}
\end{table}
\end{frame}

\begin{frame}[containsverbatim]
\begin{table}
\begin{tabular}{l|l}
\verb|add r0,r0|
& \verb|r0| $\gets 0$, \verb|cf| $\gets 1$ \\
\verb|sbb r1,r1|
& \verb|r1| $\gets -1$ \\
\verb|neg r0|
& \verb|r0| $\gets 0$, \verb|cf| $\gets 0$ \\
\verb|adc r1,r1|
& \verb|r1| $\gets -2$ \\
\end{tabular}
\end{table}
\end{frame}

\begin{frame}[containsverbatim]
\begin{table}
\begin{tabular}{l|l}
$P_0$ & \verb|mov r1,r0;| \\
$P_1$ & \verb|xor r1,r1; and r1,r0;| \\
$P_2$ & \verb|sub r1,r1; and r1,r0;| \\
$P_3$ & \verb|xor r1,r1; add r1,r0;| \\
$P_4$ & \verb|sub r1,r1; add r1,r0;| \\
$P_5$ & \verb|add r0,r0; sbb r1,r1; inc r1;| \\
$P_6$ & \verb|add r0,r0; sbb r1,r1; sub r1,r0; adc r1,r0;| \\
$P_7$ & \verb|add r0,r0; sbb r1,r1; neg r0; adc r1,r1;| \\
$P_8$ & \verb|xor r1,r1; xor r2,r2; xor r3,r3; inc r2; dec r3;|\\
      & \verb| cmp r1,r0; cmovl r1,r2; cmovg r1,r3;| \\
\end{tabular}
\end{table}
\end{frame}

\begin{frame}
\begin{table}
\begin{tabular}{*{9}{c}}
$P_0$    & $P_1$    & $P_2$    & $P_3$    & $P_4$    & $P_5$    & $P_6$    & $P_7$    & $P_8$    \\
\hline
0.119 ms & 0.175 ms & 0.284 ms & 0.281 ms & 0.389 ms & 0.447 ms & 0.966 ms & 0.679 ms & 0.673 ms \\
\end{tabular}
\end{table}
\end{frame}

\begin{frame}
\begin{table}
\begin{tabular}{l|*{9}{c}}
      & $P_0$    & $P_1$    & $P_2$    & $P_3$    & $P_4$    & $P_5$    & $P_6$    & $P_7$    & $P_8$    \\
\hline
$P_0$ & 0.116 ms & 0.176 ms & 0.284 ms & 0.281 ms & 0.389 ms & 0.447 ms & 0.965 ms & 0.679 ms & 0.670 ms \\
$P_1$ &          & 0.235 ms & 0.343 ms & 0.340 ms & 0.449 ms & 0.507 ms & 1.025 ms & 0.757 ms & 0.729 ms \\
$P_2$ &          &          & 0.468 ms & 0.449 ms & 0.553 ms & 0.613 ms & 1.131 ms & 0.845 ms & 0.837 ms \\
$P_3$ &          &          &          & 0.422 ms & 0.529 ms & 0.592 ms & 1.107 ms & 0.821 ms & 0.834 ms \\
$P_4$ &          &          &          &          & 0.636 ms & 0.698 ms & 1.212 ms & 0.927 ms & 0.941 ms \\
$P_5$ &          &          &          &          &          & 0.752 ms & 1.270 ms & 0.984 ms & 1.001 ms \\
$P_6$ &          &          &          &          &          &          & 1.781 ms & 1.535 ms & 1.530 ms \\
$P_7$ &          &          &          &          &          &          &          & 1.171 ms & 1.224 ms \\
$P_8$ &          &          &          &          &          &          &          &          & 1.155 ms \\
\end{tabular}
\end{table}
\end{frame}

\end{document}
